import{h as j,y as G,P as X,g as Z,a3 as oe,d as ne,a4 as re,a5 as q,D as y,o as r,b as p,w as U,F as I,m as n,n as se,r as A,M as R,E as z,c as T,t as H,a as Q,J as de,a6 as ue,I as pe,k as me,a0 as ie,_ as ce}from"./framework.T2MPfnQk.js";import{_ as ve}from"./EnhancedElForm.vue_vue_type_style_index_0_scoped_e959d30d_lang.Vm_MAv6r.js";import{E as ye}from"./index.jmOsIY2Q.js";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const _e=u=>typeof u<"u";function Ve(u){return JSON.parse(JSON.stringify(u))}function be(u,m,O,k={}){var B,C,_;const{clone:S=!1,passive:J=!1,eventName:V,deep:x=!1,defaultValue:M,shouldEmit:b}=k,t=oe(),d=O||(t==null?void 0:t.emit)||((B=t==null?void 0:t.$emit)==null?void 0:B.bind(t))||((_=(C=t==null?void 0:t.proxy)==null?void 0:C.$emit)==null?void 0:_.bind(t==null?void 0:t.proxy));let c=V;m||(m="modelValue"),c=c||`update:${m.toString()}`;const i=s=>S?typeof S=="function"?S(s):Ve(s):s,w=()=>_e(u[m])?i(u[m]):M,N=s=>{b?b(s)&&d(c,s):d(c,s)};if(J){const s=w(),$=j(s);let h=!1;return G(()=>u[m],E=>{h||(h=!0,$.value=i(E),X(()=>h=!1))}),G($,E=>{!h&&(E!==u[m]||x)&&N(E)},{deep:x}),$}else return Z({get(){return w()},set(s){N(s)}})}const he={class:"footer-wrap"},Ee=ne({__name:"EnhancedElForm",props:{modelValue:{},schema:{default:()=>[]},labelWidth:{default:""},canEditing:{type:Boolean},isInline:{type:Boolean},enterSearch:{type:Function,default:()=>{}},labelPosition:{default:"right"},disabled:{type:Boolean},alwaysEditableColumns:{default:()=>[]}},setup(u,{expose:m,emit:O}){const k=u,B=O,{schema:C,canEditing:_,labelWidth:S,isInline:J,enterSearch:V,labelPosition:x,disabled:M,alwaysEditableColumns:b}=re(k),t=be(k,"modelValue",B),d=q(new Set),c=j(!1),i=j(),w=q({}),N=a=>a.render?a.render(t):"";b.value.forEach(a=>d.add(a)),G(()=>k.schema,a=>{for(let l=0;l<a.length;l++){const v=a[l],{prop:f,defaultValue:F=""}=v;console.log("ðŸš€ ~ defaultValue:",F),t.value.hasOwnProperty(f)||(t.value[f]=F)}},{immediate:!0});const s=Z(()=>_.value?C.value.map(l=>{const{prop:v,type:f}=l;if(!d.has(v)&&l.type!=="slot")return ve.omit(l,"type");const F=async()=>{var D;if((D=l.attrs)==null||D.onBlur,f==="input"&&!b.value.includes(v))try{await K(v),d.delete(v)}catch(P){console.log(P)}};return l.attrs={...l.attrs,onBlur:F},l}):C.value),$=()=>{var a;c||(a=V.value)==null||a.call(V)},h=a=>{d.add(a),X(()=>{var l;(l=w[a])==null||l.focus()})},E=a=>{a?d.delete(a):(d.clear(),b.value.forEach(l=>d.add(l)))},g=(...a)=>{var l;return(l=i.value)==null?void 0:l.validate(...a)},ee=(...a)=>{var l;return(l=i.value)==null?void 0:l.resetFields(...a)},K=(...a)=>{var l;return(l=i.value)==null?void 0:l.validateField(...a)};return m({editingColumn:d,clearEditingColumn:E,validate:g,resetFields:ee,validateField:K,scrollToField:a=>{var l;return(l=i.value)==null?void 0:l.scrollToField(a)},clearValidate:(...a)=>{var l;return(l=i.value)==null?void 0:l.clearValidate(...a)}}),(a,l)=>{const v=y("el-option"),f=y("el-select"),F=y("el-radio"),D=y("el-radio-group"),P=y("el-date-picker"),le=y("el-input"),te=y("EnhancedElForm",!0),ae=y("el-form-item");return r(),p(n(ye),{ref_key:"enhancedElFormRef",ref:i,class:"enhanced-el-form",inline:n(J),model:n(t),"label-width":n(S),disabled:n(M),"label-position":n(x),onKeyup:l[1]||(l[1]=ie(e=>typeof n(V)=="function"?$():()=>{},["enter"])),onCompositionstart:l[2]||(l[2]=e=>c.value=!0),onCompositionend:l[3]||(l[3]=e=>c.value=!1)},{default:U(()=>[(r(!0),T(I,null,z(s.value,e=>(r(),p(ae,{key:e.prop,rules:e.rules,label:e.label||"",prop:e.prop,class:se(`clazz-${e.prop} ${n(_)&&!e.type?"curosr-pointer":""}`),onClick:W=>n(_)&&h(e.prop)},{default:U(()=>{var W,L;return[e.type==="slot"?A(a.$slots,`form-${e.prop}`,{key:0,config:e,isEditing:d.has(e.prop)},void 0,!0):typeof e.render=="function"?(r(),p(N,{key:1,render:e.render},null,8,["render"])):e.type==="select"?(r(),p(f,R({key:2},e.attrs?e.attrs:{},{modelValue:n(t)[e.prop],"onUpdate:modelValue":o=>n(t)[e.prop]=o,onChange:o=>e.change?e.change(o,n(t)):()=>{}}),{default:U(()=>[(r(!0),T(I,null,z(e.options,(o,Y)=>(r(),p(v,{key:Y,value:typeof o=="object"?o.value:o,label:typeof o=="object"?o.label:o},null,8,["value","label"]))),128))]),_:2},1040,["modelValue","onUpdate:modelValue","onChange"])):e.type==="radio"?(r(),p(D,{key:3,modelValue:n(t)[e.prop],"onUpdate:modelValue":o=>n(t)[e.prop]=o},{default:U(()=>[(r(!0),T(I,null,z(e.options,(o,Y)=>(r(),p(F,{key:Y,label:o.value},{default:U(()=>[Q(H(o.label),1)]),_:2},1032,["label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):e.type==="datepicker"?(r(),p(P,R({key:4,modelValue:n(t)[e.prop],"onUpdate:modelValue":o=>n(t)[e.prop]=o,"value-format":"YYYY-MM-DD"},e.attrs),null,16,["modelValue","onUpdate:modelValue"])):e.type==="input"?(r(),p(le,R({key:5,ref_for:!0,ref:o=>w[e.prop]=o,modelValue:n(t)[e.prop],"onUpdate:modelValue":o=>n(t)[e.prop]=o},e.attrs),null,16,["modelValue","onUpdate:modelValue"])):e.type?(r(),p(de(`el-${e.type}`),R({key:6,modelValue:n(t)[e.prop],"onUpdate:modelValue":o=>n(t)[e.prop]=o},e.attrs),null,16,["modelValue","onUpdate:modelValue"])):(r(),T(I,{key:7},[Q(H(((W=e.formater)==null?void 0:W.call(e,n(t)[e.prop]))||n(t)[e.prop]),1)],64)),pe(te,{schema:(L=e.nestedSchema)==null?void 0:L.call(e,n(t)[e.prop]),modelValue:n(t),"onUpdate:modelValue":l[0]||(l[0]=o=>ue(t)?t.value=o:null)},null,8,["schema","modelValue"])]}),_:2},1032,["rules","label","prop","class","onClick"]))),128)),me("div",he,[A(a.$slots,"footer",{},void 0,!0)])]),_:3},8,["inline","model","label-width","disabled","label-position"])}}}),we=ce(Ee,[["__scopeId","data-v-e959d30d"]]);export{we as E};
