import{h as j,y as G,P as H,g as Q,a3 as le,d as te,a4 as ae,a5 as L,D as y,o as r,b as p,w as U,F as I,m as n,n as oe,r as ne,M as N,E as z,c as O,t as q,a as A,J as re,a0 as se,_ as de}from"./framework.d3e9wyiU.js";import{_ as ue}from"./EnhancedElForm.vue_vue_type_style_index_0_scoped_4e27f85f_lang.qRrHKohl.js";import{E as pe}from"./index.SJefeE_9.js";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const ie=u=>typeof u<"u";function me(u){return JSON.parse(JSON.stringify(u))}function ce(u,i,R,k={}){var x,C,_;const{clone:F=!1,passive:J=!1,eventName:b,deep:B=!1,defaultValue:M,shouldEmit:V}=k,a=le(),d=R||(a==null?void 0:a.emit)||((x=a==null?void 0:a.$emit)==null?void 0:x.bind(a))||((_=(C=a==null?void 0:a.proxy)==null?void 0:C.$emit)==null?void 0:_.bind(a==null?void 0:a.proxy));let c=b;i||(i="modelValue"),c=c||`update:${i.toString()}`;const m=s=>F?typeof F=="function"?F(s):me(s):s,S=()=>ie(u[i])?m(u[i]):M,D=s=>{V?V(s)&&d(c,s):d(c,s)};if(J){const s=S(),w=j(s);let f=!1;return G(()=>u[i],h=>{f||(f=!0,w.value=m(h),H(()=>f=!1))}),G(w,h=>{!f&&(h!==u[i]||B)&&D(h)},{deep:B}),w}else return Q({get(){return S()},set(s){D(s)}})}const ve=te({__name:"EnhancedElForm",props:{modelValue:{},schema:{},labelWidth:{default:""},canEditing:{type:Boolean},isInline:{type:Boolean},enterSearch:{type:Function,default:()=>{}},labelPosition:{default:"right"},disabled:{type:Boolean},alwaysEditableColumns:{default:()=>[]}},emits:["update:modelValue"],setup(u,{expose:i,emit:R}){const k=u,x=R,{schema:C,canEditing:_,labelWidth:F,isInline:J,enterSearch:b,labelPosition:B,disabled:M,alwaysEditableColumns:V}=ae(k),a=ce(k,"modelValue",x),d=L(new Set),c=j(!1),m=j(),S=L({}),D=t=>t.render?t.render(a):"";V.value.forEach(t=>d.add(t)),G(()=>k.schema,t=>{if(t)for(let l=0;l<t.length;l++){const v=t[l],{prop:E,defaultValue:$=""}=v;a.value.hasOwnProperty(E)||(a.value[E]=$)}},{immediate:!0});const s=Q(()=>_.value?C.value.map(l=>{const{prop:v,type:E}=l;if(!d.has(v)&&l.type!=="slot")return ue.omit(l,"type");const $=async()=>{var T;if((T=l.attrs)==null||T.onBlur,E==="input"&&!V.value.includes(v))try{await K(v),d.delete(v)}catch(P){console.log(P)}};return l.attrs={...l.attrs,onBlur:$},l}):C.value),w=()=>{var t;c||(t=b.value)==null||t.call(b)},f=t=>{d.add(t),H(()=>{var l;(l=S[t])==null||l.focus()})},h=t=>{t?d.delete(t):(d.clear(),V.value.forEach(l=>d.add(l)))},X=(...t)=>{var l;return(l=m.value)==null?void 0:l.validate(...t)},Z=(...t)=>{var l;return(l=m.value)==null?void 0:l.resetFields(...t)},K=(...t)=>{var l;return(l=m.value)==null?void 0:l.validateField(...t)};return i({editingColumn:d,clearEditingColumn:h,validate:X,resetFields:Z,validateField:K,scrollToField:t=>{var l;return(l=m.value)==null?void 0:l.scrollToField(t)},clearValidate:(...t)=>{var l;return(l=m.value)==null?void 0:l.clearValidate(...t)}}),(t,l)=>{const v=y("el-option"),E=y("el-select"),$=y("el-radio"),T=y("el-radio-group"),P=y("el-date-picker"),g=y("el-input"),ee=y("el-form-item");return r(),p(n(pe),{ref_key:"enhancedElFormRef",ref:m,class:"enhanced-el-form",inline:n(J),model:n(a),"label-width":n(F),disabled:n(M),"label-position":n(B),onKeyup:l[0]||(l[0]=se(e=>typeof n(b)=="function"?w():()=>{},["enter"])),onCompositionstart:l[1]||(l[1]=e=>c.value=!0),onCompositionend:l[2]||(l[2]=e=>c.value=!1)},{default:U(()=>[(r(!0),O(I,null,z(s.value,e=>(r(),p(ee,{key:e.prop,rules:e.rules,label:e.label||"",prop:e.prop,class:oe(`clazz-${e.prop} ${n(_)&&!e.type?"curosr-pointer":""}`),onClick:W=>n(_)&&f(e.prop)},{default:U(()=>{var W;return[e.type==="slot"?ne(t.$slots,`form-${e.prop}`,{key:0,config:e,isEditing:d.has(e.prop)},void 0,!0):typeof e.render=="function"?(r(),p(D,{key:1,render:e.render},null,8,["render"])):e.type==="select"?(r(),p(E,N({key:2},e.attrs?e.attrs:{},{modelValue:n(a)[e.prop],"onUpdate:modelValue":o=>n(a)[e.prop]=o,onChange:o=>e.change?e.change(o,n(a)):()=>{}}),{default:U(()=>[(r(!0),O(I,null,z(e.options,(o,Y)=>(r(),p(v,{key:Y,value:typeof o=="object"?o.value:o,label:typeof o=="object"?o.label:o},null,8,["value","label"]))),128))]),_:2},1040,["modelValue","onUpdate:modelValue","onChange"])):e.type==="radio"?(r(),p(T,{key:3,modelValue:n(a)[e.prop],"onUpdate:modelValue":o=>n(a)[e.prop]=o},{default:U(()=>[(r(!0),O(I,null,z(e.options,(o,Y)=>(r(),p($,{key:Y,label:o.value},{default:U(()=>[A(q(o.label),1)]),_:2},1032,["label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):e.type==="datepicker"?(r(),p(P,N({key:4,modelValue:n(a)[e.prop],"onUpdate:modelValue":o=>n(a)[e.prop]=o,"value-format":"YYYY-MM-DD"},e.attrs),null,16,["modelValue","onUpdate:modelValue"])):e.type==="input"?(r(),p(g,N({key:5,ref_for:!0,ref:o=>S[e.prop]=o,modelValue:n(a)[e.prop],"onUpdate:modelValue":o=>n(a)[e.prop]=o},e.attrs),null,16,["modelValue","onUpdate:modelValue"])):e.type?(r(),p(re(`el-${e.type}`),N({key:6,modelValue:n(a)[e.prop],"onUpdate:modelValue":o=>n(a)[e.prop]=o},e.attrs),null,16,["modelValue","onUpdate:modelValue"])):(r(),O(I,{key:7},[A(q(((W=e.formater)==null?void 0:W.call(e,n(a)[e.prop]))||n(a)[e.prop]),1)],64))]}),_:2},1032,["rules","label","prop","class","onClick"]))),128))]),_:3},8,["inline","model","label-width","disabled","label-position"])}}}),he=de(ve,[["__scopeId","data-v-4e27f85f"]]);export{he as E};
